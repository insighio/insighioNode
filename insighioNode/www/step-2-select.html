<!DOCTYPE html>

<html>

    <head>
        <meta charset="UTF-8" />
        <title>insigh.io Device</title>
        <link rel="stylesheet" href="css/style.css" />
        <link rel="stylesheet" href="css/spectre.min.css" />
    </head>

    <body class="body-custom">

        <img src="img/logo.png" class="img-responsive img-center">

        <div class="panel panel-custom">
          <div class="panel-header">
            <div class="panel-title text-center">Select desired operation</div>
          </div>

          <div class="panel-nav">
            <ul class="step">
              <li class="step-item"><a>Login</a></li>
              <li class="step-item active"><a>Select Network</a></li>
              <li class="step-item"><a>Network Params</a></li>
              <li class="step-item"><a>API Keys</a></li>
              <li class="step-item"><a>Measurements</a></li>
              <li class="step-item"><a>Timing</a></li>
              <li class="step-item"><a>Verify</a></li>
            </ul>
          </div>

          <div class="panel-body">
            <br />
            <hr />
            <br />
            <div class="text-center">Select network technology to be used:</div>
            <br />
            <div id="loader" class="loading loading-lg"></div>
            <br />
            <div class="container">
              <div class="columns flex-centered">
                <div class="column col-6 col-xl-8 col-md-10 col-sm-12">
                <!-- <div class="column col-8 col-mr-auto img-center"> -->
                  <div class="btn-group btn-group-block img-center">
                    <button class="btn" id="button-wifi" onclick="operationSelected('WiFi')">WiFi</button>
                    <button class="btn" id="button-cellular" onclick="operationSelected('Cellular')">Cellular</button>
                    <button class="btn" id="button-lora" onclick="operationSelected('LoRa')">LoRa</button>
                    <button class="btn" id="button-satellite" onclick="operationSelected('Satellite')">Satellite</button>
                  </div>
                </div>
             </div>
             <br />
             <script src="js/js.cookie.min.js"></script>
             <script src="js/utils.js"></script>
             <script >
               var mac = undefined
               function initializeValues() {
                 fetch("/devid").then((response) => {
                   return response.json();
                 }).then(function(data) {
                   mac =  data.id
                   showElement('loader', false)
                 }).catch((err) => {
                   console.log("error completing request", err);
                   showElement('loader', false)
                 });
               }

               function clearCookies() {
                 Cookies.remove('board-mac')
                 Cookies.remove('network')
                }

                function operationSelected(operationName) {
                   clearCookies();
                   Cookies.set('board-mac', mac)

                   document.getElementById('button-wifi').disabled = true
                   document.getElementById('button-cellular').disabled = true
                   document.getElementById('button-lora').disabled = true
                   document.getElementById('button-satellite').disabled = true
                   if(operationName == "WiFi")
                      location.href = "step-3-config-wifi.html";
                  else if(operationName == "Cellular")
                     location.href = "step-3-config-cellular.html";
                  else if(operationName == "LoRa")
                     location.href = "step-3-config-lora.html";
                  else if(operationName == "Satellite") {
                    location.href = "step-3-config-sat-astro.html"
                  }
                }

              clearCookies()
              initializeValues()
            </script>
          </div>
      </div>
    </body>

</html>
